services:
  dut:
    build:
      context: .
      dockerfile: images/Dockerfile.dut
    container_name: Device-Under-Test
    privileged: true
    networks:
      net:
        ipv4_address: 192.168.0.2
      nexthop1:
        ipv4_address: 10.0.1.2
      nexthop2:
        ipv4_address: 10.0.2.2
      nexthop3:
        ipv4_address: 10.0.3.2
      nexthop4:
        ipv4_address: 10.0.4.2

  tg:
    build:
      context: .
      dockerfile: images/Dockerfile.tg
    container_name: Traffic-Generator
    privileged: true
    networks:
      net:
        ipv4_address: 192.168.0.3

  nexthop_1:
    build:
      context: .
      dockerfile: images/Dockerfile.nexthop
    container_name: Nexthop-1
    volumes:
      - ./pcaps:/pcaps
    privileged: true
    networks:
      nexthop1:
        ipv4_address: 10.0.1.3

  nexthop_2:
    build:
      context: .
      dockerfile: images/Dockerfile.nexthop
    container_name: Nexthop-2
    volumes:
      - ./pcaps:/pcaps
    privileged: true
    networks:
      nexthop2:
        ipv4_address: 10.0.2.3

  nexthop_3:
    build:
      context: .
      dockerfile: images/Dockerfile.nexthop
    container_name: Nexthop-3
    volumes:
      - ./pcaps:/pcaps
    privileged: true
    networks:
      nexthop3:
        ipv4_address: 10.0.3.3

  nexthop_4:
    build:
      context: .
      dockerfile: images/Dockerfile.nexthop
    container_name: Nexthop-4
    volumes:
      - ./pcaps:/pcaps
    privileged: true
    networks:
      nexthop4:
        ipv4_address: 10.0.4.3

networks:
  net:
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.0.0/24
  nexthop1:
    driver: bridge
    ipam:
      config:
        - subnet: 10.0.1.0/24
  nexthop2:
    driver: bridge
    ipam:
      config:
        - subnet: 10.0.2.0/24
  nexthop3:
    driver: bridge
    ipam:
      config:
        - subnet: 10.0.3.0/24
  nexthop4:
    driver: bridge
    ipam:
      config:
        - subnet: 10.0.4.0/24
